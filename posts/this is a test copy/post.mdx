# Eco - Identity Access Management

IAM service responsible for checking user access to any resource or http route.

## Contents

- [Run](#run)
- [Test](#test)
- [Deploy](#deploy)
- [TODOs](#todos)
- [Used Libraries](#libraries)
- [Diagrams](#diagrams)
  - [Component diagram](#component-diagram)
  - [Sequence Diagram](#sequence-diagram)
- [Database Tables](#database-tables)
  - [User domain](#user-domain)
  - [Role domain](#role-domain)
  - [City domain](#city-domain)
  - [Permission domain](#permission-domain)
- [Run Temporal Scripts](#run-temporal-scripts)
- [Installation List](#installation-list)
- [Wiki](#wiki)

## Run

1. Install go version 1.19.5 from this [link](https://go.dev/doc/install).
2. Clone IAM project by:

```sh
$ git clone https://git.ecobin.ir/ecomicro/IAM
```

3. Make sure to set `GOPATH` and `GOPRIVATE`

```sh
export GOPATH="path/to/bin/go"
export GOPRIVATE="git.ecobin.ir"
```

4. Install dependencies by:

```sh
$ go get
$ go mod tidy
$ sudo apt-get install build-essential
$ sudo apt-get -y install make
$ go install github.com/cosmtrek/air@latest
```

5. Install docker from this [link](https://docs.docker.com/engine/install/)
6. run project by:

```sh
$ make watch
```

## Test

You need to install run dependencies first, then run tests by:

```sh
$ make test
```

## Deploy

Deploy project by:

```sh
$ make docker
$ docker-compose up -d
```

## TODOs

## Libraries

- [casbin](https://github.com/casbin/casbin)
  - An authorization library that supports access control models like ACL, RBAC, ABAC
- [sonyflake](https://github.com/sony/sonyflake)
  - A distributed unique ID generator inspired by Twitter's Snowflake
- [gin](https://github.com/gin-gonic/gin)
  - HTTP web framework written in Go
- [testify](https://github.com/stretchr/testify)
  - A toolkit with common assertions and mocks that plays nicely with the standard library
- [swag](https://github.com/swaggo/swag)
  - Automatically generate RESTful API documentation with Swagger 2.0
- [grpc](https://google.golang.org/grpc)
  - The Go implementation of gRPC
- [protobuf](https://google.golang.org/grpc)
  - Go implementation for protocol buffers, which is a language-neutral, platform-neutral, extensible mechanism for serializing structured data
- [go-redis](https://github.com/go-redis/redis)
  - Type-safe Redis client for Golang
- [gorm](https://gorm.io/gorm)
  - ORM library for Golang

## run temporal scripts

Run new user workflow with `./scripts/new_user.json` parameters.

```sh
$ ./scripts/tctl.sh new_user
```

## installation list

- docker
- make
- air
- gcc (for kafka)
- swag

## wiki

Please check [wiki](https://git.ecobin.ir/ecomicro/IAM/-/wikis/home) to get detailed information.
